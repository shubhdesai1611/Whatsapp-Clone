{"ast":null,"code":"var _jsxFileName = \"/Users/shubhdesai/Documents/VS Code/Wp/client/src/chat/chat/Messages.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { Box, styled } from \"@mui/material\";\nimport { useContext } from \"react\";\nimport { AccountContext } from \"../../context/AccountProvider\";\nimport { getMessages, newMessage } from \"../../service/api\";\nimport { Message } from \"./Message\";\n\n//Component\nimport Footer from \"./Footer\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Wrapper = styled(Box)`\n  background-image: url(${\"https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png\"});\n`;\n_c = Wrapper;\nconst Component = styled(Box)`\n  height: 80vh;\n  overflow-y: scroll;\n`;\n_c2 = Component;\nconst Container = styled(Box)`\n  padding: 1px 80px;\n`;\n_c3 = Container;\nconst Messages = _ref => {\n  _s();\n  let {\n    person,\n    conversation\n  } = _ref;\n  const {\n    account\n  } = useContext(AccountContext);\n  const [value, setValue] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [newMessageFlag, setMessageFlag] = useState(false);\n  // to store files\n  const [file, setFile] = useState();\n  //get and set image url\n  const [image, setImage] = useState(\"\");\n  const scrollRef = useRef();\n  useEffect(() => {\n    const getMessageDetails = async () => {\n      let data = await getMessages(conversation._id);\n      setMessages(data);\n    };\n    conversation._id && getMessageDetails();\n  }, [person._id, conversation._id, newMessageFlag]);\n  useEffect(() => {\n    var _scrollRef$current;\n    console.log(\"In\");\n    (_scrollRef$current = scrollRef.current) === null || _scrollRef$current === void 0 ? void 0 : _scrollRef$current.scrollIntoView({\n      transition: \"smooth\"\n    });\n  }, [messages]);\n  const sendText = async e => {\n    const code = e.keyCode || e.which;\n    if (code == 13) {\n      let message = {};\n      if (!file) {\n        message = {\n          senderId: account.sub,\n          receiverId: person.sub,\n          conversationId: conversation._id,\n          type: \"text\",\n          text: value\n        };\n      } else {\n        //console.log(\"here\");\n        message = {\n          senderId: account.sub,\n          receiverId: person.sub,\n          conversationId: conversation._id,\n          type: \"file\",\n          text: image\n        };\n      }\n      console.log(message);\n      await newMessage(message);\n      setValue(\"\");\n      setFile(\"\");\n      setImage(\"\");\n      setMessageFlag(prev => !prev);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Wrapper, {\n    children: [/*#__PURE__*/_jsxDEV(Component, {\n      children: messages && messages.map(message => /*#__PURE__*/_jsxDEV(Container, {\n        ref: scrollRef,\n        children: /*#__PURE__*/_jsxDEV(Message, {\n          message: message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {\n      sendText: sendText,\n      setValue: setValue,\n      value: value,\n      file: file,\n      setFile: setFile,\n      setImage: setImage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n_s(Messages, \"bgbUzmYhjmGrjtcF9R0xSnlgQlc=\");\n_c4 = Messages;\nexport default Messages;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"Wrapper\");\n$RefreshReg$(_c2, \"Component\");\n$RefreshReg$(_c3, \"Container\");\n$RefreshReg$(_c4, \"Messages\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Box","styled","useContext","AccountContext","getMessages","newMessage","Message","Footer","jsxDEV","_jsxDEV","Wrapper","_c","Component","_c2","Container","_c3","Messages","_ref","_s","person","conversation","account","value","setValue","messages","setMessages","newMessageFlag","setMessageFlag","file","setFile","image","setImage","scrollRef","getMessageDetails","data","_id","_scrollRef$current","console","log","current","scrollIntoView","transition","sendText","e","code","keyCode","which","message","senderId","sub","receiverId","conversationId","type","text","prev","children","map","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c4","$RefreshReg$"],"sources":["/Users/shubhdesai/Documents/VS Code/Wp/client/src/chat/chat/Messages.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { Box, styled } from \"@mui/material\";\nimport { useContext } from \"react\";\nimport { AccountContext } from \"../../context/AccountProvider\";\nimport { getMessages, newMessage } from \"../../service/api\";\nimport { Message } from \"./Message\";\n\n//Component\nimport Footer from \"./Footer\";\n\nconst Wrapper = styled(Box)`\n  background-image: url(${\"https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png\"});\n`;\n\nconst Component = styled(Box)`\n  height: 80vh;\n  overflow-y: scroll;\n`;\n\nconst Container = styled(Box)`\n  padding: 1px 80px;\n`;\n\nconst Messages = ({ person, conversation }) => {\n  const { account } = useContext(AccountContext);\n  const [value, setValue] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [newMessageFlag, setMessageFlag] = useState(false);\n  // to store files\n  const [file, setFile] = useState();\n  //get and set image url\n  const [image, setImage] = useState(\"\");\n\n  const scrollRef = useRef();\n\n  useEffect(() => {\n    const getMessageDetails = async () => {\n      let data = await getMessages(conversation._id);\n      setMessages(data);\n    };\n    conversation._id && getMessageDetails();\n  }, [person._id, conversation._id, newMessageFlag]);\n\n  useEffect(() => {\n    console.log(\"In\");\n    scrollRef.current?.scrollIntoView({ transition: \"smooth\" });\n  }, [messages]);\n\n  const sendText = async (e) => {\n    const code = e.keyCode || e.which;\n    if (code == 13) {\n      let message = {};\n      if (!file) {\n        message = {\n          senderId: account.sub,\n          receiverId: person.sub,\n          conversationId: conversation._id,\n          type: \"text\",\n          text: value,\n        };\n      } else {\n        //console.log(\"here\");\n        message = {\n          senderId: account.sub,\n          receiverId: person.sub,\n          conversationId: conversation._id,\n          type: \"file\",\n          text: image,\n        };\n      }\n\n      console.log(message);\n      await newMessage(message);\n      setValue(\"\");\n      setFile(\"\");\n      setImage(\"\");\n      setMessageFlag((prev) => !prev);\n    }\n  };\n\n  return (\n    <Wrapper>\n      <Component>\n        {messages &&\n          messages.map((message) => (\n            <Container ref={scrollRef}>\n              <Message message={message} />\n            </Container>\n          ))}\n      </Component>\n      <Footer\n        sendText={sendText}\n        setValue={setValue}\n        value={value}\n        file={file}\n        setFile={setFile}\n        setImage={setImage}\n      />\n    </Wrapper>\n  );\n};\n\nexport default Messages;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}